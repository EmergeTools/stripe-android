name: financial-connections-pr
on:
  pull_request:
jobs:
  # Use emerge tools to analyze the example app size
  apk-size-analysis:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/stripe_setup
      - name: Upload release bundle to Emerge
        run: ./gradlew :financial-connections-example:emergeUploadReleaseAab
        env:
          EMERGE_API_KEY: ${{ secrets.EMERGE_API_KEY }}

  # Use emerge tools to run snapshot tests
  snapshot-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/stripe_setup
      - name: Upload snapshots bundle to Emerge
        run: ./gradlew :financial-connections-example:emergeUploadSnapshotBundleDebug
        env:
          EMERGE_API_KEY: ${{ secrets.EMERGE_API_KEY }}
